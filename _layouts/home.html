<!DOCTYPE html>
<html>
  {% include head.html %}

  <body>
    {% include header.html %}

    <div class="page-content">
      <div class="wrapper">
        <div class="home">
          <img
            src="{{ page.profile_picture.src | absolute_url }}"
            alt="{{ page.profile_picture.alt }}"
            class="profile-pic"
          />

          {{ content }}
        </div>
      </div>
    </div>

    <div class="container">

  <form id="user-form">
    <div class="input-container">
      <input type="text" id="user-text1" placeholder="Duck no">
      <input type="text" id="user-text2" placeholder="Enter your name">
      <input type="text" id="user-text3" placeholder="Date">
    </div>
    <button type="submit">Submit</button>
  </form>

  <div id="user-input">
    <h2>Found Ducks:</h2>
    <ul id="name-list"></ul>
  </div>
</div>

<script>
  const form = document.getElementById('user-form');
const userInput1 = document.getElementById('user-text1');
const userInput2 = document.getElementById('user-text2');
const userInput3 = document.getElementById('user-text3');
const nameList = document.getElementById('name-list');

form.addEventListener('submit', function(e) {
  e.preventDefault();
  const inputValue1 = userInput1.value;
  const inputValue2 = userInput2.value;
  const inputValue3 = userInput3.value;
  userInput1.value = '';
  userInput2.value = '';
  userInput3.value = '';

  //const now = new Date();
  //const currentDateAndTime = now.toString();

  const now = new Date();
  const year = now.getFullYear();
  const month = String(now.getMonth() + 1).padStart(2, '0'); // Month index starts from 0, pad with 0 if single digit
  const day = String(now.getDate()).padStart(2, '0'); // Pad with 0 if single digit
  const hours = String(now.getHours()).padStart(2, '0'); // Pad with 0 if single digit
  const minutes = String(now.getMinutes()).padStart(2, '0'); // Pad with 0 if single digit
  const seconds = String(now.getSeconds()).padStart(2, '0'); // Pad with 0 if single digit
  const milliseconds = String(now.getMilliseconds()).padStart(3, '0'); // Pad with zeros if necessary
  
  const currentDateAndTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}.${milliseconds}`;

  appendToNameList(inputValue1, inputValue2, currentDateAndTime);
  saveToDatabase(inputValue1, inputValue2, inputValue3);
});

function appendToNameList(name1, name2, name3) {
  const newListItem = document.createElement('li');
  newListItem.textContent = 'Duck- ' + name1 + ' is found by ' + name2 + ' on  ' + name3;
  nameList.appendChild(newListItem);
}

function saveToDatabase(name1, name2, name3) {
  fs.readFile('./database/names.json', 'utf8', (err, data) => {
    if (err) {
      console.error(err);
      return;
    }

    const names = JSON.parse(data);
    names.push({ name1, name2, name3 });

    fs.writeFile('./database/names.json', JSON.stringify(names), 'utf8', (err) => {
      if (err) {
        console.error(err);
      }
    });
  });
}

function loadFromDatabase() {
  fs.readFile('./database/names.json', 'utf8', (err, data) => {
    if (err) {
      console.error(err);
      return;
    }

    const names = JSON.parse(data);
    names.forEach(({ name1, name2, name3 }) => {
      appendToNameList(name1, name2, name3);
    });
  });
}

// When the database is set up, replace the /database/names.jason file with the correct jason, and uncomment the line below.
//loadFromDatabase();
  
</script>

<style>
  /* CSS styles for positioning and styling the form elements */
  .container {
    text-align: center;
  }

  .input-container {
    display: flex;
    justify-content: center;
  }

  .input-container input {
    margin-right: 10px;
    padding: 5px;
  }

  button {
    margin-top: 10px;
    padding: 5px 10px;
  }
</style>

    {% include footer.html %}

    {% include foot.html %}
  </body>
  
</html>
